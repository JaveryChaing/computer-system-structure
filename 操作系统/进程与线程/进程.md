## 进程

- **全驱图定义**

> *前驱图是一个有向无循环图，图中的每个结点可用于表示一条语句、一个程序段或进程；结点间的有向边表示在两结点之间存在的偏序或前驱关系“→”，→={（Pi，Pj）|Pi必须在Pj开始前完成}。如果（Pi，Pj）∈→，可写成Pi→Pj，称Pi是Pj的前驱，而Pj是Pi的直接后继*
>
> eg：
>
> P1→P2，P1→P3，P1→P4，P2→P5，P3→P5，P4→P6，P5→P7，P6→P7
>
> ![image-20220110165748905](image-20220110165748905.png) 



- #### **程序顺序执行**

> 顺序执行的程序特征
>
> 1. 处理机的操作严格按程序规定的顺序执行，即只有前一操作结束后才能执行后继操作
> 2. 程序执行的封闭性。程序独占全机资源，因而机内各资源的状态（除初始状态外）只有本程序才能改变。程序一旦开始运行，**其执行结果不受外界因素的影响**
> 3. 程序执行结果的确定性。程序执行的结果与它的执行速度无关，任何都不会影响得到最终结果
> 4. 程序结果的可再现性。



- #### **程序并发执行**

> 并发执行的程序特征
>
> 1. 程序执行间断性（多个执行任务存在相互等待资源）
> 2. 程序执行失去封闭性（多个执行任务存在相互影响）
> 3. 程序结构不可再现性
> 4. 程序和计算不再对应



- #### **多道程序设计**

> *让多个程序同时进入计算机执行* 主要提供计算机处理效率，提升系统效率



- #### **进程**

> 多道程序工作环境下，程序的并发执行特征使用进程概述，进程包括程序段，数据段，及进程控制块3部分
>
> **进程：** 
>
> 1. 程序在处理机上执行时**所发生的活动**称为进程（Dijkstra）
> 2. 进程可以和别的计算并发
> 3. 进程是一个**程序及其数据**在处理机上**顺序执行**时所发生的活动
> 4. 程是程序在一个数据集合上的运行过程，是系统进行资源分配和调度的一个**独立单位**（Peter Denning）。
>
> **程序与进程区别：**
>
> 1. 进程是**程序的一次执行**，完成程序的特定功能的指令有序序列（一个进程可以执行几个程序）
> 2. 进程是系统进行资源**分配和调度**的一个独立单位，程序则是以多个用户进程共享一个编译程序
> 3. 程序可用作为一种软件**资源长期保存**，进程是临时的，有生命周期，表现在它由创建而产生，完成任务后撤销
> 4. 进程具有结构，描述进程变化过程
>
> **进程特征**
>
> 1. 动态性
> 2. 并发性
> 3. 独立性（独立运行的基本单位，同时也是系统中独立获得资源和独立调度的基本单位）
> 4. 异步性（执行不可见）
>
> **进程基本状态及其转换**
>
> 1. 就绪（当前进程已分配到处理机以外所有必要的资源）
> 2. 执行
> 3. 阻塞（**进程因某种事件而暂停执行状态**）
>
> ![image-20220110210051136](image-20220110210051136.png) 
>
> - 执行->就绪状态（通常出现在分时系统中，正在执行的进程时间片用完被暂停）
> - 阻塞->就绪状态（阻塞进程不能直接运行，需要重新获得处理器执行权）
>
> 
>
> #### **五状态进程模型**（在基本状态下进一步划分)
>
> 1. 创建（New）
> 2. 就绪（Ready）
> 3. 运行（Run）
> 4. 阻塞（Blocked）
> 5. 结束（Exit）
>
> - **主要状态转换**
>
>   1. 创建
>   2. 提交
>   3. 调度运行
>   4. 释放（进程完成、失败导致终止。包括异常退出）
>   5. 超时(时间片用完，优先级高进程对其进行抢占)
>   6. 事件等待
>   7. 事件出现
>
>   ![image-20220110211722689](image-20220110211722689.png) 
>
> 
>
> #### **七状态进程模型**
>
> *五状态进程模型没有区分进程空间地址，进程的数据载入时间存在影响*
>
> ![image-20220111193814577](image-20220111193814577.png) 
>
> - **进程状态**
>   1. 就绪（Ready） 进程在内存且可以立即进入执行状态
>   2. 阻塞（Blocked）进程在内存等待事件出现
>   3. 阻塞挂起(Suspend) 进程在外存并等待事件出现
>   4. 就绪挂起 （进程在外存，需要进入内存执行）
>   
> - **进程状态转换**
>   1. 活动就绪->静止就绪 （**禁止就绪状态的进程不再被调度**）
>   2. 活动阻塞->静止阻塞 （执行进程转为活动阻塞，活动阻塞在变为静止阻塞）
>   3. 静止就绪->活动就绪 
>
> - **进程挂起场景**
>
>   1. 终端用户进程调试（执行状态暂停）
>   2. 父进程修改子进程，或挂起自己的子进程
>   3. 操作系统优化
>   4. 进程对换（缓解内存紧张，将内存中阻塞进程转至外存）
>   5. 负载调节
>
>
> #### **进程控制块(PCB)**
>
> *PCB 作用是使进程成为一个能**独立运行的基本单位，一个能与其他进程并发执行**的进程。操作系统调度进程时，要从该进程的PCB中所保存的处理机状态信息去设置该进程恢复运行的现场，并根据PCB中的程序数据内存地址找到数据。进程执行过程中，需要和其他线程实现同步。PCB可以被操作系统中多个模块修改，中断，分析*
>
> **PCB中信息**
>
>    1. **进程标识符信息**（唯一标识，存储在内存）分为外部标识符（用户访问进程使用）；内部标识符（操作系统访问，通常描述子父进程，用户进程标识）
>   2. **处理机状态信息** （存储在寄存器中，描述执行线程信息）
>      1. 通用寄存器（暂存信息）
>
>      2. 指令计数器（存放访问下一条指令地址）
>
>      3. 程序状态字（PSW，包含条件码，执行方式，中断屏蔽标志）
>
>      4. 用户栈指针（对应系统栈，用于**存放过程**和**系统调用参数及地址**）
>      3. **进程调度信息**（进程调度与进程对换相关信息）
>      1. 进程状态（就绪，运行，阻塞）
>      2. 进程优先级
>      3. 进程调度所需其他信息
>      4. 事件（阻塞原因）
>   4. **进程控制信息**
>        1. 程序和数据地址
>        2. 进程同步和通信机制
>        3. 资源清单
>        4. 链接指针（指向下进程PCB首地址）
>
> 
>
> #### **进程组织方式**
>
> - 链接方式
>
>   把具有**相同状态或策略**的进程块分组链接成队列
>
>   ![image-20220111111302823](image-20220111111302823.png) 
>
> - 索引方式
>
>   根据**进程状态**建立索引表（索引表指针存在专用单元）
>
>   ![image-20220111111327747](image-20220111111327747.png) 
>
> 
>
> #### **进程控制**
>
> *主要任务是创建和撤销进程以及实现进程的状态转换，进程控制主要由操作系统内核完成*
>
> - 操作系统内核提供的功能（机器指令，原子操作）
>
>   1. 中断处理
>   2. 进程管理（创建，状态转换，进程调度，并发执行）
>   3. 资源管理（时钟，I/O设备，文件系统）
>
> - **进程创建**
>
>   子进程可以继承父进程所有资源，进程创建另一进程事件有
>
>   1. 用户登录（系统创建用户进程，用户进程在创建其他任务进程）
>   2. 作业调度（分批处理）
>   3. 提供服务
>   4. 应用请求
>
>   **进程创建流程**
>
>   1. 申请空白进程控制块，分配唯一数字标识符
>   2. 为新的进程对程序，数据及用户栈分配必要的内存空间（操作系统必须知道新进程所需内存大小）
>   3. 初始化进程控制块（初始化标识符信息，父类进程标识符填入，初始化处理机状态，程序计数器，将进程状态设置为就绪或静止就绪状态）
>   4. 将进程插入就绪队列中
>
> 
>
>   **进程终止**
>
>   - 引起进程终止事件
>     1. 正常结束（中断，由操作系统执行）
>     2. 异常结束（程序异）
>     3. 外界干预（父类进程可以结束子类进程）
>
>   - 进程终止过程
>
>     1. 根据终止程序的标识符读取进程状态
>
>     2. 终止该进程执行，并重新调度其他进程
>
>     3. 存在子进程，将子进程终止
>
>     4. 将该进程所有资源归还父类进程或系统
>
>     5. 将终止进程从队列中移出
>
> **进程阻塞与唤醒**
>
> - 引起进程阻塞和唤醒的事件
>
>   1. 进程请求服务系统（不能立即获取结果）
>   2. 启动操作
>   3. 同步其他进程
>   4. 无新任务可做（使用事件唤醒工作）
>
> - 进程阻塞过程(**进程主动行为**)
>
> 
>
>  **进程的挂起与激活**
>
> *外部事件引起进程暂停执行*
>
> 挂起：检查被挂起
>
> 
>
> #### **进程调度**
>
> *系统能按某种算法，动态地把处理机分配给就绪队列中的一个进程，使之执行。分配处理机的任务是由进程调度程序完成的。由于处理机是最重要的计算机资源，提高处理机的利用率及改善系统性能（吞吐量、响应时间）在很大程度上取决于进程调度性能的好坏，因而进程调度成为操作系统设计的中心问题之一*
>
> 
>
> #### 进程调度的功能
>
> 1. 进程调度程序就是通过**进程控制块PCB来准确地掌握系统中所有进程的执行情况和状态特征**的
> 2. 进行进程上下文切换
>
> 
>
> **调度方式**
>
> - 非剥夺式（处理机分配进程后一致进行下去，知道任务完成）
>
> 

