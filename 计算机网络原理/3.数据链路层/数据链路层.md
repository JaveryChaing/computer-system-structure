## **数据链路层**

> 结点：主机，路由器
>
> 链路：结点之间物理通道
>
> 数据链路：网络中两个结点之间逻辑通道（实现数据传输协议的硬件与软件）
>
> 帧：链路层协议数据单元，封装网络层数据报
>
> **数据链路层实现功能**
>
> *加强物理层传输原始比特流，将物理连接改为逻辑上无差错的数据链路*
>
> - 为网络层提供服务
> - 链路建立，维持，释放
> - 组帧
> - 流量控制
> - 差错控制
>
> 组帧：在数据前后加上特殊标识，使接收端根据标识读取数据开始及结束（帧同步）
>
> - MTU：最大传输单元（帧长）
>
> - 组帧方法
>
>   1. 字符计数：帧首部字段标识数据长度
>   2. 字符填充：SOT，EOT特殊字符标识（添加转义字符）
>   3. **零比特填充**：在发送端扫描整个数据，连续5个1就立即填入一个0
>   4. **违规编码法**：通过曼彻斯特编码规定帧的起止（一个周期内高-高，低-低电平判断帧头）
>
> 
>
> **差错控制**（噪声影响，提供信噪比减少干扰，链路层差错控制通常检验比特位错）
>
> - 位错（比特位出错）
>
>   1. **检错编码**（积偶校验，循环冗余码CRC）
>
>      **积/偶检验**：加上校验单元，判断比特位为1的个数是奇数还是偶数（检测能力50%）
>
>      **CRC循环冗余码：**  
>
>      ```sql
>      发送端									     接收端
>       数据 % 多项式 = FCS   
>                          发送数据(数据+FCS)---->  
>       								    	接收数据 % 多项式 = 0 （无差错）
>      
>      ```
>
>      $FCS位数为多项式的阶（多项式N位，其阶位N-1，\\若多显示采用X^n+X^{n-1}+...描述，其转换规则为存在阶级补1，不存在补0）$ 
>
>      多项式为10011，发送数据为1101 011011 ，FCS为1110，最终发送数据为 1101 011011 1110
>
>      ![image-20230304225038477](D:\code\computer-system-structure\计算机网络原理\3.数据链路层\image-20230304225038477.png) 
>
>   2. **纠错编码**（海明码，能发现双比特错，纠正单比特错） 
>
> 
>
> **流量控制与可靠传输机制** （解决发送与接收速度不匹配问题，及丢帧处理）
>
> - 反馈帧：接收方收不下，则不向发送端回复确认
>
> - 停止等待协议：单帧等待确认回复，效率低
>
>   > 数据帧丢失或检测到差错帧丢失：发送方超时重传
>   >
>   > ACK丢失：发送方超时重传，接收方丢去重发的帧，并返回ACK
>   >
>   > ACK延迟：发送方丢弃重复的ACK
>   >
>   > 信道利用率 =$\frac{T_D}{T_D+RTT+T_A} = L / C /T,~~~T_D：发送方占用时间，T_A：ACK处理时间，\\L表示T内发送L比特数据，C表示发送方数率， T表示发送周期$ 
>   >
>   > 信道吞吐率 = 信道利用率 *  发送方发送速率
>
> - 滑动窗口协议
>
>   1. GBN（后退N帧协议，发送窗口大于1，接收端口等于1）
>
>      > 
>
>   2. SR（选择重传协议，发送接收端口均大于1）
>
>      > 

