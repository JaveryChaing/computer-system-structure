### 计算机系统结构

> 1. 逻辑机器
> 2. 微程序机器
> 3. 传统机器(虚拟机)
> 4. 操作系统机器
> 5. 汇编语言机器
> 6. 高级语言机器
> 7. 应用程序机器

**上层语言语句是由下层语言翻译及解释实现**

固件:具有软件功能的硬件

微程序:对应机器指令

#### 计算机组成与实现

**组成** 

> 系统结构的逻辑实现,包括机器级的数据流和控制流组成及逻辑设计,在指令系统结构确定分配给硬件系统的功能和概念结构之后,研究各内部组成部分的内部结构和相互关联
>
> 计算机组成应该考虑因素
>
> 1. 数据通路宽度确定(并行上传信息位数)
> 2. 专用部件设置(特殊器间,使用频率,价格)
> 3. 操作对部件的共享程度(分时使用/并行使用)
> 4. 部件的并行度(采用顺序串行,重叠,流水线或分布式处理)
> 5. 控制机构的组成方式(事件,操作排序,硬联控制,微程序控制)
> 6. 缓存和排队技术(FIFO,FILO,循环处理事件顺序)
> 7. 可靠性技术(冗余,容错)

**实现**

> 计算机组成的物理实现,包括机器部分的物理结构,模块,电源划分及连接,物理性能包括,电参数,传输速度,动态范围,集成度

**区别**

系统结构,计算机组成,和计算机实现划分

* 系统结构主要考虑计算机系统硬件与软件划分
* 计算机组成是系统结构的逻辑实现
* 计算机实现是计算机组成的物理实现

**计算机系统设计定量分析原理**

> > 1. 加快处理经常性事件的速度
> >
> > 2. Amdahl定律(指出衡量与比较的途径) 
> >
> >    > ![](image-20210831112302670.png)
> >    >
> >    > 
> >    >
> >    > $T_0$: 改进前执行任务时间
> >    >
> >    > $T_n$:改进后执行任务时间
> >    >
> >    > $F_e$:性能改进比
> >    > $Se$:部件加速度比
> >
> > 3. **CPU性能分析**
> >
> >    > cpu时间 = 程序CPU时钟周期数 * 时钟周期长度 = 一个程序CPU时钟周期/时钟频率
> >    >
> >    > $CPI=TC/IC$  CPU时间 = (IC*CPI)*时钟周期长度 = (IC*CPI)/频率
> >    >
> >    > IC:程序执行指令数 (取决于系统结构的指令集和编译技术)
> >    >
> >    > TC:执行程序花费的时钟周期  
> >    >
> >    > CPI:执行某个程序的平均时钟周期数(取决于系统结构组成和指令集的设计与实现)
> >    >
> >    > CPU时钟周期数 = $\sum_{n=1}^N(CPI_i\times I_i)$
> >    >
> >    > 每条指令平均时钟周期数为:$CPI=\frac{{\sum_{i=1}^n(CPI_i \times I_i)}}{IC}=\sum_{i=1}^n(CPI_i \times \frac{I_i}{IC})$  
> >
> > 4. **并行原理**
> >
> >    > 问题中具有可同时进行运算或操作的特性,并行性包括同时性和并发性
> >    >
> >    > 并行:多个事件在同一时刻发生
> >    >
> >    > 并发:多个事件在同一时间间隔发生
> >    >
> >    > 在计算机系统中,运算的并行性体现在
> >    >
> >    > 1. 时间重复(多个处理过程在时间上错开,轮流重复使用同一套硬件的各个部分)
> >    > 2. 资源重复(设置硬件资源来提高可靠性或性能)
> >    > 3. 资源共享(利用软件方法让多个用户共用一套资源)
> >    >
> >    > 开发并行处理技术是提高现代计算机系统性能最主要途径之一,并行性级别
> >    >
> >    > 1. 微操作级:执行一条指令的多个微操作之间并行
> >    > 2. 指令级:多条指令的并行执行
> >    > 3. 进程\线程级:程序的多个线程并行执行(多个线程的系统结构允许不同地址空间上的多方进程同时运行)
> >    > 4. 作业级\程序级:(程序之间并行运行)
> >    >
> >    > **按数据处理的并行性**
> >    >
> >    > 1. 字串位串(串行单处理机)
> >    > 2. 字串位并(同时对所有位进行处理)
> >    > 3. 字并位串(同时对多个字一位处理)
> >    > 4. 字并位并(多个字的全部处理)
> >    >
> >    > **按器件或功能单元并行性**
> >    >
> >    > 1. 存储器操作并行(一个存储周期内,并行访问多个字)
> >    > 2. 处理器操作步骤并行(在时间上重叠的流水进行)
> >    > 3. 处理器操作并行(硬件支持一条指令操作多个数据)
> >    > 4. 多机并行(指令,任务,作业并行)
> >    >
> >    > **计算机系统并行性的量度**
> >    >
> >    > 1. 指令级并行度(ILP)
> >    > 2. 线程级并行度(TLP)
> >    > 3. 数据级并行度(DLP)
> >    > 4. 多机系统耦合度
> >
> >    **并行处理系统的结构**
> >
> >    > 1. 流水线(部件重叠时间并行)
> >    > 2. 阵列(资源重复空间并行)
> >    > 3. 多处理机(资源共享时空异步并行)
> >    > 4. 数据流处理机(数据共享,指令控制)
> >
> >    **访问局部性原理**
> >
> >    程序执行中频繁重复使用那些最近已使用过的数据和指令(最近使用的资源可用马上被访问;空间局部性,被访问地址相邻的信息可能一起被访问) ===>虚拟存储器/Cache系统
>
> **计算机系统评价**
>
> 1. 性能
>
>    > MIPS 对于给定的程序,每秒百万条指令数  
>    >
>    > MIPS = $\frac{指令条数}{执行时间 \times10^6}=\frac{时钟频率}{CPI\times10^6}$
>    >
>    > 程序执行时间: $T_e=\frac{指令频率}{MIPS\times10^6}$
>    >
>    > 使用MIPS有三个不足
>    >
>    > 1. 依赖与指令集(不同指令集的机器测试性能时不准确)
>    > 2. 与具体的执行程序有关
>    > 3. 与硬件执行指令有关
>
>    > MFLOPS 每秒百万次浮点操作次数(浮点运算)
>    >
>    > MFLOPS=$\frac{浮点操作次数}{执行时间\times10^6}$
>    >
>    > MFLOPS不能体现机器的整体性能,一般适用于向量机 1MFLOPS≈3MIPS
>
> 2. 成本
>
>    > 1. 硬件开发和生产成本
>    > 2. 软件开发成本
>    > 3. 附加成本(电,折旧)

**器件,软件,应用对计算机系统结构影响**

> 冯诺依曼机的结构特征(运算器,控制器,存储器,输入/输出设备)
>
> 1. 结构原理基础是**存储程序原理**,即程序和数据放在存储器中,按照程序中指令的逻辑顺序逐条取指令,分析指令,执行指令
> 2. 指令和数据二进制形式表示
> 3. 单处理机结构,数据传以运算器为中心,I/O设备与存储器之间的数据传输度要经过运算器
> 4. 存储器提供地址访问(固定字长.每个地址唯一)
> 5. 指令串行执行(计数器要指示执行指令的地址)
> 6. 数据结构简单

> 现代计算机系统结构改进
>
> 1. 运算器改为以存储器为核心,DMA,通道,外围处理机
> 2. 更改CPU顺序执行的组成方式(现行控制,重叠,流水线)
> 3. 增加新的高级数据表示
> 4. 程序运行中不允许更改指令
> 5. 存储器多样化
> 6. 指令系统由复杂指令改为**精简指令系统(RISC)**
>
> 软件对系统结构影响
>
> >  可移植性
> >
> > 1. 系列机方法(机器语言统一),X86指令集  ARM64指令集
> > 2. 模拟与仿真(一种机器的系统结构上实现另一种机器的指令系统)
> > 3. 统一高级语言方法
>
> 应用对系统结构影响
>
> > 1. 通用型机器
> > 2. 专用型机器(专门领域,气象模拟,流体流动,人工智能)

### 计算机指令系统

> 指令系统是机器的主要属性,是计算机系统软,硬件分界面的组要标志
>
> > **数据类型**(防止不同类型的数据之间相互操作)
> >
> > 1. 基本类型
> > 2. 结构类型(数组,字符,向量,堆栈,队列)
> >
> > **数据表示与数据结构**
> >
> > 数据表示:构成数据结构的元素,数据结构通过软件映射,将信息转换为机器中各种基本数据类型表示
>
> 
>
> > **浮点数据表示**(有效数字和数的范围在计算机的一个存储单元表示)
> >
> > 1. 机器浮点数只能表示数轴上分散与正负两个区间上的**部分**离散值; 
> >
> > 2. 在机器中表示一个浮点数时,
> >
> >    > **尾数M**(用定点小数表示,尾数部分给出有效数字的位数,决定浮点数的精度)
> >    >
> >    > **指数E** (阶码,整数形式表示,指明小数点在数据中的位置,确定浮点数表示的范围)
> >    >
> >    > **符号位S**(表示正负)
> >
> > 
> >
> > ![image-20210831162119621](image-20210831162119621.png)
> >
> > ![image-20210831162222081](image-20210831162222081.png)
> >
> > ![image-20210831165414029](image-20210831165414029.png)
> >
> > 32位浮点数的真值表示为$(-1)^s\times M \times2^e$    $e=E-127$
> >
> > 64位浮点数的真值表示$(-1)^s\times M\times2^e$       $e=E-1023$
> >
> >   
> >
> > **浮点运算尾数下溢处理方法**
> >
> > 1. 截断法(设尾数有效数位为m,则最大误差接近于$2^{-m}$ 
> > 2. 恒置法(恒置r/2法)
> > 3. 舍入法
> > 4. 查表舍入法
>
>   
>
> **自定义数据表示**
>
> > 1. 带标志符的数据表示(功能+类型+值)  
> >
> >    > 简化指令系统
> >    >
> >    > 简化编译器
> >    >
> >    > 便于硬件自动实现一致性检查和自动完成数据类型转换
> >    >
> >    > 简化程序设计
> >    >
> >    > 增加主存空间
> >    >
> >    > 降低指令执行速度
> >
> > 2. 数据描述表示法(描述符和数据分开存放,数组,向量)
>
> ##### 寻址技术
>
> > 寻找数据和其他信息的地址技术(编址方式,寻址方式和定位方式,研究对象寄存器,主存器,堆栈和输入输出设备,目的是以最短的位描述给定的寻址方式,有效的使用程序存储器)
> >
> > **编址方式**
> >
> > > **字编址**:每一个编址单位包含的信息量(二进制位数)与访问一次存储设备获得的信息量一致(不支持非数值计算) 
> > >
> > > 主要问题是存储单位与访问单位不一致问题
> > >
> > > ![image-20210831195303686](image-20210831195303686.png)
> >
> > **字节编址**(字节编码问题)
> >
> > > 1. 小端存储
> > > 2. 大端存储
> > > 3. ![image-20210831195731233](image-20210831195731233.png)
> >
> > **位编址**
> >
> > 存储单元的每一位都有一个地址
> >
> > **编址方式**
> >
> > CPU直接访问的存储信息主要来自通用寄存器,堆栈,主存和I/O设备
> >
> > 1. 独立编址(各自从0开始独立编址)
> > 2. 寄存器独立编址(输入/输入设备统一编址)
> > 3. 统一编址(存在容量较大的高速缓存存储器,通过硬件进程切换进行编址)
> > 4. 采用堆栈寻址的运算指令,通过顶部指针自动决定(不需要地址)
>
> 
>
> 
>
> 









