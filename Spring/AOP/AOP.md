## AOP面向对象编程

AOP（Aspect Orient Programming)，保证开发者不修改源代码情况下，为系统业务组件中增强功能。

- 静态AOP（对class文件进行代理更改，AspectJ)

  > 代理类与被代理类实现同样接口（代理类同时拥有被搭理类对象，与装饰者模式类似，*装饰器模式关注于在一个对象上动态的添加方法，然而代理模式关注于控制对对象的访问*）

- 动态AOP（在JDK内存中代理，或CGlib动态代理）

  > JDK动态代理：使用反射机制生成一个实现代理接口的类
  >
  > CGlib 代理：将代理对象类的class文件加载进来，通过修改其字节码生成子类来处理。

|      类别      |    机制     |                             原理                             |           优点           |            缺点            |
| :------------: | :---------: | :----------------------------------------------------------: | :----------------------: | :------------------------: |
|    静态AOP     |  静态织入   |     在编译时，切面直接以字节码形式编译到目标字节码文件中     |        无性能影响        |           不灵活           |
|    动态AOP     | JDK动态代理 |  运行期间，目标类为接口动态生成代理类，将切面织入到代理类中  |   对于静态AOP更加灵活    | 需要实现接口，对性能有影响 |
|   动态字节码   |    CGLIB    | 运行期间，目标类加载后，动态生成目标类的子类，将切面逻辑加入到子类中 |        无接口织入        | 无法对final修饰的类进行AOP |
| 自定义类加载器 |             |     运行期间，目标类加载前，将切面逻辑加入到目标字节码中     | 对于绝大部分的类进行织入 |   代码中使用其他类加载器   |
|   字节码转换   |             |           运行期间，所有类加载器加载字节码进行拦截           |     对所有类进行织入     |                            |

 

#### **Spring AOP代理**

> - **创建AOP代理**
>
>   > AnnotationAwareAspectJAutoProxyCreator
