## 优化服务器设置

> ![image-20211223111004992](image-20211223111004992.png) 
>
> - datadir 数据存储路径
>
> - socket （socket套接字文件，只允许本地登录） 
>
> - pid-file 记入当前mysqld的进程（防止启动多个进程副本，**只有获取PID文件写入权限的进程才能更改文件**）
>
> - **Buffer Pool**  内存数据大小，基于内存更改，同步到日志与磁盘  默认128MB 
>
>   - ~~~sql
>      -- 查看INNODB 
>       show engine innodb status ; 
>      ~~~
>
>      - Total memory allocated，这就是说buffer pool最终的总大小是多少
>      - Buffer pool size，这就是说buffer pool一共能容纳多少个缓存页
>      - Free buffers，这就是说free链表中一共有多少个空闲的缓存页是可用的
>      - Database pages和Old database pages，就是说lru链表中一共有多少个缓存页，以及冷数据区域里的缓存页数量
>      - Modified db pages，这就是flush链表中的缓存页数量
>      - Pending reads和Pending writes，等待从磁盘上加载进缓存页的数量，还有就是即将从lru链表中刷入磁盘的数量、即将从flush链表中刷入磁盘的数量
>      - Pages made young和not young，这就是说已经lru冷数据区域里访问之后转移到热数据区域的缓存页的数 量，以及在lru冷数据区域里1s内被访问了没进入热数据区域的缓存页的数量
>      - youngs/s和not youngs/s，这就是说每秒从冷数据区域进入热数据区域的缓存页的数量，以及每秒在冷数据区域里被访问了但是不能进入热数据区域的缓存页的数量
>      - Pages read xxxx, created xxx, written xxx，xx reads/s, xx creates/s, 1xx writes/s，这里就是说已经读取、创建和写入了多少个缓存页，以及每秒钟读取、创建和写入的缓存页数量
>      - Buffer pool hit rate xxx / 1000，这就是说每1000次访问，有多少次是直接命中了buffer pool里的缓存的
>      - young-making rate xxx / 1000 not xx / 1000，每1000次访问，有多少次访问让缓存页从冷数据区域移动到了热数据区域，以及没移动的缓存页数量
>      - LRU len：这就是lru链表里的缓存页的数量
>      - I/O sum：最近50s读取磁盘页的总数
>      - I/O cur：现在正在读取磁盘页的数量
>
>   - ![image-20211223112057206](image-20211223112057206.png) 
>
>   - ![image-20211223114745576](image-20211223114745576.png)  
>
> - Log File 
>
> #### **配置内存使用**
>
> - 连接线程内存
>
>   - sort_buffer_size 会话缓存
>
> - 缓存内存
>
>   - InnoDB 缓存池 (buffer pool)
>
>   - InnoDB日志文件
>
>   - 查询缓存
>
> - 线程缓存(Thread_cache_size)
>
>   - 迅速响应连接请求(*创建新连接是,缓存中有线程存在,MYSQL从缓存中删除一个线程,并且把它分配给这个新连接,连接关闭时,将该线程返回缓存池中*,__可以不必每个连接都创建新线程 一个线程处理多个Client请求__
>
>   - thread_cache_size 指定MYSQL可以保存在缓存中的线程数 
>
>   - ~~~sql
>     show global status like 'thread_cache_size';
>     -- 服务器中获取
>     set global thread_cache_size = 16;
>     -- my.cnf 中配置
>     thread_concurrency = 16 
>     ~~~
>
> - 表缓存(Table Cache)
>
>   - 缓存**.frm**文件(表结构)的解析结果
>
> - **InnoDB 数据字典**
>
>   - 存储表信息(描述,字段,对象)  sys_tables,sys_columns,sys_indexs,sys_fields
>   - sys_table存储表的信息，包括表面，ID，表空间号
>     sys_columns存储表中列的信息，包括列名，列ID，列的序号，列的类型，长度等信息
>     sys_index存储表的索引信息，包括索引名，索引对应的表空间，表ID，索引ID,索引类型
>     sys_fields存储索引中定义的索引列
>   - 第一次打开表时,将系统表数据从磁盘加载到内存中缓存
>
> 
>
> - **InnoDB I/O配置**
>   - ![image-20211223145856095](D:\code\computer-system-structure\高性能MYSQL\优化服务器设置\image-20211223145856095.png)

